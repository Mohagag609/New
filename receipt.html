<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>إيصال</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            direction: rtl;
            margin: 20px;
        }
        .receipt-container {
            width: 80%;
            margin: auto;
            padding: 20px;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }
        .details-table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        .details-table td {
            padding: 12px;
            border: 1px solid #eee;
        }
        .details-table td:first-child {
            font-weight: bold;
            width: 30%;
        }
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 0.9em;
            color: #777;
        }
        @media print {
            body { margin: 0; }
            .receipt-container { border: none; box-shadow: none; width: 100%; }
            button { display: none; }
        }
    </style>
</head>
<body>
    <div class="receipt-container">
        <h1 id="receipt-title">إيصال</h1>
        <table class="details-table">
            <tr><td>رقم الحركة:</td><td id="receipt-id"></td></tr>
            <tr><td>التاريخ:</td><td id="receipt-date"></td></tr>
            <tr><td>المبلغ:</td><td id="receipt-amount"></td></tr>
            <tr><td>البيان:</td><td id="receipt-details"></td></tr>
            <tr><td>الوصف:</td><td id="receipt-description"></td></tr>
        </table>
        <div class="footer">
            <p>هذا إيصال تم إنشاؤه بواسطة نظام الخزينة.</p>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const transaction = JSON.parse(localStorage.getItem('printableTransaction'));
            if (transaction) {
                document.getElementById('receipt-title').textContent = transaction.title;
                document.getElementById('receipt-id').textContent = transaction.id;
                document.getElementById('receipt-date').textContent = transaction.date;
                document.getElementById('receipt-amount').textContent = transaction.amount;
                document.getElementById('receipt-details').textContent = transaction.details;
                document.getElementById('receipt-description').textContent = transaction.description;

                // Clean up local storage after use
                localStorage.removeItem('printableTransaction');

                // Automatically trigger print dialog
                window.print();
                // Close the window after printing (or cancellation)
                window.onafterprint = window.close;
            }
        });
    </script>
</body>
</html>
